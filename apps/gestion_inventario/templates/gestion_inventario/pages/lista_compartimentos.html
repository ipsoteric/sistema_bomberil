{% extends 'gestion_inventario/layouts/base.html' %}
{% load static %}

{% block titulo_ventana %}Lista de Compartimentos{% endblock %}

{% block titulo_pagina %}
    <span class="fs_grande color_primario">
        <i class="fas fa-box me-2"></i> Compartimentos
    </span>
{% endblock %}


{% block contenido %}

<div class="container-fluid mt-4">

<div class="card shadow-sm mb-4">
    <div class="card-header fs_normal">
        <i class="fas fa-filter me-1"></i>
        Filtros
    </div>
    <div class="card-body">
        <form id="filtros" method="get" class="row g-3 align-items-end">
            <div class="col-md-4">
                <label for="ubicacion" class="form-label fw-bold fs_pequena">Ubicaci贸n</label>
                <select name="ubicacion" id="ubicacion" class="form-select form-select-sm fs_normal">
                    <option value="">-- Todas --</option>
                    {% for s in ubicaciones %}
                    <option value="{{ s.id }}" {% if request.GET.ubicacion == s.id|stringformat:'s' %}selected{% endif %}>{{ s.nombre }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-md-4">
                <label for="nombre" class="form-label fw-bold fs_pequena">Nombre contiene</label>
                <input type="search" name="nombre" id="nombre" value="{{ request.GET.nombre|default:'' }}" class="form-control form-control-sm fs_normal" placeholder="Buscar por nombre">
            </div>

            <div class="col-md-2">
                <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" name="descripcion_presente" value="1" id="descpres" {% if request.GET.descripcion_presente == '1' %}checked{% endif %}>
                    <label class="form-check-label fs_pequena" for="descpres">Tiene descripci贸n</label>
                </div>
            </div>

            <div class="col-md-2 text-end">
                <button type="submit" class="btn btn-primary btn-sm fs_normal">Filtrar</button>
                <a href="{% url 'gestion_inventario:ruta_lista_compartimentos' %}" class="btn btn-outline-secondary btn-sm fs_normal">Limpiar</a>
            </div>
        </form>
    </div>
</div>

<div class="card shadow-sm mb-4">
    <div class="card-header d-flex justify-content-between align-items-center">
        <span class="fw-bold fs_normal">
            <i class="fas fa-table me-1"></i>
            Lista de Compartimentos
        </span>
        </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-hover table-sm align-middle fs_normal">
                <thead class="fs_pequena">
                    <tr>
                        <th>Ubicaci贸n</th>
                        <th>Compartimento</th>
                        <th>Descripci贸n</th>
                        <th class="text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody class="fs_normal">
                    {% for c in compartimentos %}
                    <tr>
                        <td>
                            <a href="{% url 'gestion_inventario:ruta_gestionar_ubicacion' c.ubicacion.id %}">{{ c.ubicacion.nombre }}</a>
                        </td>
                        <td><strong>{{ c.nombre }}</strong></td>
                        <td>{{ c.descripcion|default:'-' }}</td>
                        <td class="text-center">
                            <a class="btn btn-sm btn-outline-primary fs_normal" href="{% url 'gestion_inventario:ruta_detalle_compartimento' compartimento_id=c.id %}">Ver</a>
                            <a class="btn btn-sm btn-outline-secondary fs_normal" href="{% url 'gestion_inventario:ruta_editar_compartimento' compartimento_id=c.id %}">Editar</a>
                            <a class="btn btn-sm btn-outline-danger fs_normal" href="{% url 'gestion_inventario:ruta_eliminar_compartimento' compartimento_id=c.id %}">Eliminar</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center fst-italic py-4">
                            No se encontraron compartimentos con los filtros seleccionados.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        </div>
</div>

</div>

{% endblock %}